// This query return list of ExploitableCVE on InternetFacing Device
let IsInternetFacingDevice=
DeviceInfo
| where IsInternetFacing // Comment this for All device result
| summarize arg_max(Timestamp, *) by DeviceId
;
DeviceTvmSoftwareVulnerabilities
| project DeviceName, OSPlatform, CveId
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on  CveId
| where IsExploitAvailable ==1
| where DeviceName in (( IsInternetFacingDevice | distinct DeviceName))
| summarize CveIDs=make_set(CveId), CveCount=dcount(CveId) by DeviceName


//REF: https://github.com/reprise99/Sentinel-Queries/blob/main/Defender%20for%20Endpoint/Vuln-PublicFacingDeviceswithKnownExploitedVuln.kql
